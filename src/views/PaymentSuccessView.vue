<script setup>
import { onMounted } from 'vue';
import { useRouter } from 'vue-router';
import { useAuthStore } from '@/stores/authStore';
import BackButton from '@/components/BackButton.vue'

const router = useRouter();
const authStore = useAuthStore();

onMounted(() => {
  // ã€ã€ã€å»ºè®® 1 ä¿®å¤ã€‘ã€‘ã€‘
  // æ”¯ä»˜æˆåŠŸ, ç«‹å³ä»åç«¯è·å–æœ€æ–°çš„ç”¨æˆ·ä¿¡æ¯
  // (æ­¤æ—¶ Webhook å·²æ‰§è¡Œ, authStore.user å°†åŒ…å«æ–°çš„ 'enrollments')
  console.log('æ”¯ä»˜æˆåŠŸ: æ­£åœ¨è·å–æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯...');
  authStore.fetchUser();
  
  // (ä½ åŸæœ‰çš„æ³¨é‡Š...)
  // çœŸå®é¡¹ç›®ä¸­, è¿™é‡Œä¼šè°ƒç”¨åç«¯ API éªŒè¯ session_id, 
  // å¹¶åœ¨æ•°æ®åº“ä¸­åˆ›å»º Enrollment è®°å½•ã€‚
  // (å¤‡æ³¨: ä½ çš„ Webhook å·²ç»åšäº†è¿™ä»¶äº‹, æ‰€ä»¥è¿™é‡Œ fetchUser() å³å¯)
});
</script>

<template>
  <div class="payment-result success">
    <BackButton 
      :fallback-route="{ name: 'courses' }" 
      text="è¿”å›è¯¾ç¨‹åˆ—è¡¨"
      small
    />
    <h1>æ”¯ä»˜æˆåŠŸï¼ğŸ‰</h1>
    <p>æ„Ÿè°¢æ‚¨è´­ä¹°æœ¬è¯¾ç¨‹ã€‚æ‚¨çš„å­¦ä¹ ä¹‹æ—…å³å°†å¼€å§‹ã€‚</p>
    <p class="small-text">ï¼ˆæ³¨æ„ï¼šè®¢å•åˆ›å»ºå°†åœ¨åç«¯ Webhook éªŒè¯åå®Œæˆï¼‰</p>
  </div>
</template>

<style scoped>
/* (Style ä¿æŒä¸å˜) */
.payment-result { max-width: 600px; margin: 50px auto; padding: 40px; text-align: center; border-radius: 8px; }
.success { background-color: #e6ffe6; border: 1px solid #5cb85c; }
h1 { color: #5cb85c; }
.small-text { margin-top: 20px; font-style: italic; color: #555; }
.btn { padding: 10px 20px; margin-top: 20px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
</style>